<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=8.0, user-scalable=yes" />
    <meta name="robots" content="noindex,nofollow" />
    <script src="https://telegram.org/js/telegram-web-app.js?2"></script>
    <title></title>
    <style>
    th, td {
        text-align: center;
        vertical-align: middle;
    }
    html, body, table.init {
        height: 100%;
    }
    table.init td {
        font-size: x-large;
    }
    body {
        margin: 0;
        background-image: linear-gradient(wheat, white);
        font-family: Arial;
    }
    table {
        width: 100%;
    }
    table.seats {
        table-layout: fixed;
    }
    table.seats div {
        position: relative;
        width: 100%;
        padding-bottom: 100%;
    }
    table.seats span {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    </style>
    <script type="text/javascript">
    function addCell(text) {
      const td = document.createElement('td');
      const div = document.createElement('div');
      const span = document.createElement('span');
      span.textContent = text;
      div.appendChild(span);
      td.appendChild(div);
      return td;
    }
    function displaySeats() {
      document.getElementsByTagName('body')[0].innerHTML = '';
      const table = document.createElement('table');
      const tbody = document.createElement('tbody');
      table.classList.add('seats');
      table.appendChild(tbody);

      var scheme = startParam.seats, width = 0, rows = 0;
      scheme = scheme.split("\n");
      for (let i in scheme)
        width = Math.max(width, scheme[i].length);
      for (let i in scheme) {
        const tr = document.createElement('tr');
        var count = 0;
        if (scheme[i].length < width)
          scheme[i] = scheme[i].padEnd(width);
        for (let j in scheme[i]) {
          const td = addCell(scheme[i][j] == ' ' ? '&nbsp;' : '[x]');
          if (scheme[i][j] != ' ')
            count++;
          tr.appendChild(td);
        }
        if (count) {
          const td = addCell(''+(rows+1));
          tr.appendChild(td);
          rows++;
        }
        tbody.appendChild(tr);
      }
      document.body.appendChild(table);
    }
    function onWindowLoad() {
        window.startParam = (new URLSearchParams(location.hash.substr(1))).get("tgWebAppStartParam");
        startParam = JSON.parse(atob(startParam));

        if (startParam.seats)
          displaySeats();
    }
    </script>
</head>

<body onload="onWindowLoad()">

<table class="init">
  <tr>
    <td>
      Загрузка...
    </td>
  </tr>
</table>

</body>
</html>
